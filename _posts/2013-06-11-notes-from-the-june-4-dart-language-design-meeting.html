---
title: 'Notes From the June 4 Dart Language Design Meeting'
layout: post
tags:
    - language
    - news
category: dart-news-and-updates
published: '2013-06-11T20:39:00-07:00'

---

<div dir="ltr" style="text-align: left;" trbidi="on"><div style="background-color: white; color: #666666; font-family: 'Open Sans'; font-size: 13.63636302947998px; line-height: 16.363636016845703px;"><span style="font-family: inherit;">The incomporable&nbsp;<a href="https://plus.google.com/100798142896685420545/posts" style="color: #2288bb; text-decoration: none;">Bob Nystrom</a>&nbsp;fills us in on the language design discussions taking place amongst Dart engineers. Here are his&nbsp;<a href="https://groups.google.com/a/dartlang.org/d/msg/misc/uhkb_79DmtA/e9VoTKFWINQJ" style="color: #2288bb; text-decoration: none;">notes from the June 4th language meeting</a>:</span></div><div class="separator" style="background-color: white; clear: both; color: #666666; font-family: 'Open Sans'; font-size: 13.63636302947998px; line-height: 16.363636016845703px;"><span style="font-family: inherit; font-size: xx-small;"><br /></span></div><div class="separator" style="background-color: white; clear: both; color: #666666; font-family: 'Open Sans'; font-size: 13.63636302947998px; line-height: 16.363636016845703px;"></div><div style="background-color: white; border: 0px; color: #222222; font-family: 'Open Sans'; font-size: 13px; line-height: 16.363636016845703px; margin: 0px; padding: 0px; vertical-align: baseline;"><div style="border: 0px; margin: 0px; padding: 0px; vertical-align: baseline;"><div class="separator" style="clear: both; color: #666666; font-size: 13.63636302947998px; line-height: 16.363636016845703px;"></div><div style="border: 0px; line-height: normal; margin: 0px; padding: 0px; vertical-align: baseline;"><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><div style="font-family: arial, sans-serif;"><div style="font-size: 13px;"><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Here's my notes. As usual all mistakes are my own:</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><b><br /></b></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><b>are boxed doubles identical?</b></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-family: Arial, Helvetica, sans-serif; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><span style="border: 0px; font-family: arial, sans-serif; margin: 0px; padding: 0px; vertical-align: baseline;">There is a bug where doubles with the same value may return false for&nbsp;</span><span style="border: 0px; font-family: courier new, monospace; margin: 0px; padding: 0px; vertical-align: baseline;">identical()</span><span style="border: 0px; font-family: arial, sans-serif; margin: 0px; padding: 0px; vertical-align: baseline;">&nbsp;because they have been boxed to different objects.</span></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-family: Arial, Helvetica, sans-serif; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><span style="border: 0px; font-family: arial, sans-serif; margin: 0px; padding: 0px; vertical-align: baseline;">Lars said it's been discussed. For doubles,&nbsp;</span><span style="border: 0px; font-family: courier new, monospace; margin: 0px; padding: 0px; vertical-align: baseline;">identical()</span><span style="border: 0px; font-family: arial, sans-serif; margin: 0px; padding: 0px; vertical-align: baseline;">&nbsp;should return true based on value. We don't want the language spec to have to mention boxing so that the VM is free to optimize how it wants.</span></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Gilad asked if NaN is identical to NaN?</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Lars says yes. It's identical but not equal. Gilad will fix the spec.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><b>change uninitialized field error to warning?</b></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Uninitialized final fields are currently an error in the language. Kasper suggests making it a warning. It seems in line with other stuff in language. It's easy to associate some value with an uninitialized final.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Gilad says we can do this and asked why Kasper ran into it. Kasper saw some bugs where implementations behaved differently in some related corner cases.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Lars doesn't have a problem with it.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><b>const instance variables</b></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Gilad's view is that they should work like statics except for scoping. Apparently, though, it's complicating the VM implementation of instance metadata. Three solutions:</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">1. No const instance fields.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">2. Metadata is statically scoped.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">3. Try to do it correctly.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Lars likes 1. I say 1 simplifies things for users. Right now, people get confused with static final const etc. Gilad is OK with 1.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">I asked if the syntax would be "static const" or just "const"? Users get confused when having to do "static" with constants.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Lars says they are confused because they don't understand the system. Requiring "static" will help them understand what's going on.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><b>what liberties can editor take with type system</b></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><i>[I didn't have a lot of context here, so I'm fuzzy on the details.]</i></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Dan Rubel asked how flexible the analyzer can be with the Dart type system and how it can extend it.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Gilad is OK with things like type inference for auto-complete. What other things should we allow?</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Lars says step one is to do exactly what the spec says. Going beyond that and helping user with refactoring and stuff is great. Using it for warnings gets strange. If you go from the Editor to command line, you would get different warnings.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Dan's concern is more about false positives. We should look at code and see if they use constructs like guarded type promotion.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Lars says if users are using these constructs a lot, we should change the language to support them. If you want to have a type guard match thing we should have a different construct. But for now, the analyzer should go with the current spec.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Kasper says we have to be careful if we report fewer warnings because users will get used to that and then get confused if other tools follow the spec more closely and have more warnings.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><b>stack traces</b></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Lars had lots of discussions back and forth with some internal Dart users. One issue is about catching exceptions and capturing stack traces and how its painful for some. Lars is OK if severe errors like noSuchMethod automatically get a stack trace.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Kasper says that would mean two ways to access stack traces. I note that with async, it's three. Lars says Florian has some idea of a constant flag to enable/disable stack trace capturing.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Gilad asks if the spec would have to lay out which errors get stack traces and which don't? Lars says they'll come up with a proposal.</div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;"><br /></div><div style="border: 0px; font-size: 13px; margin: 0px; padding: 0px; vertical-align: baseline;">Cheers!</div></div></div><div style="font-family: arial, sans-serif; font-size: 13px;"><br /><span style="font-family: 'Open Sans'; font-size: 13.63636302947998px; line-height: 18.18181800842285px;">As always, view the&nbsp;</span><a href="http://gsdview.appspot.com/dart-editor-archive-integration/latest/changelog.html" style="color: #1155cc; font-family: 'Open Sans'; font-size: 13.63636302947998px; line-height: 18.18181800842285px; text-decoration: none;" target="_blank">changelog</a><span style="font-family: 'Open Sans'; font-size: 13.63636302947998px; line-height: 18.18181800842285px;">&nbsp;for the full list of changes, and to get started with the&nbsp;Editor&nbsp;see our&nbsp;</span><a href="http://www.dartlang.org/editor/" style="color: #1155cc; font-family: 'Open Sans'; font-size: 13.63636302947998px; line-height: 18.18181800842285px; text-decoration: none;" target="_blank">tutorial</a><span style="font-family: 'Open Sans'; font-size: 13.63636302947998px; line-height: 18.18181800842285px;">.</span></div></div></div></div></div></div>
