---
title: 'js.dart Makes an Appearance on G+'
layout: post
tags: {  }
category: dartery
published: '2012-09-24T23:18:00-07:00'

---

Vijay Menon <a href="https://plus.google.com/u/0/114045999004646044580/posts/27uYMrJfcU6" target="_blank">announced on Google+</a> that the JS interop library he's been working on is coming along.<br /><br />I'll be checking this out as soon as possible, with the first task being to rewrite the Channel API library using js.dart rather than custom events.&nbsp;I also want to see what it's like to write a library in Dart and expose it to JavaScipt. If nice JavaScript APIs can be built with little effort on top of Dart libraries it would be a huge boon to Dart, in my opinion.<br /><br />The library is up on guthub, but the most interesting part to scan right now is the <a href="http://dart-lang.github.com/js-interop/docs/js.html" target="_blank">dartdoc page</a>.<br /><br />A few things about js.dart that might be interesting to readers:<br /><br /><ol><li>The library is implemented on top of synchronous isolate send ports. Those will be useful for other purposes as well, including Dart&lt;-&gt;Dart proxies across isolates.</li><li>The library requires a bit of manual memory management, either via retain() and release() calls, or by running JS interop code inside a scoped() closure. See the dartdoc for examples.</li><li>The API currently provides untyped proxies to JavaScript objects, that is they don't have a Dart interface defined based on the Javascript object. Currently that would be impossible, because you can't define a class at runtime in Dart. It should be possible to hand-write typed wrappers on those proxies, but they will have to be careful to play well with the memory management. APIs with objects that have a very obvious lifetime should be relatively easy to wrap, I think.</li><li>Lists and Maps require special handling. Because arrays and objects are built-ins in JavaScript and there are no interfaces you won't be able to just send a Dart List to JS and always have it work as expected. It's impossible (with out ES6 Proxies or Object.observe) to invoke Dart modification methods like add() and remove() when the collections are modified in JS. This means that Dart Lists and Maps must be copied into JS, and read back later.</li></ol><div>It will be very interesting to see if automatic memory management can be made to work and if typed wrappers could be generated from JavaScript annotated with <a href="https://developers.google.com/closure/compiler/docs/js-for-compiler" target="_blank">Closure-style type annotations</a>.&nbsp;</div><div><br /></div><div>All-in-all this is a very exciting development for Dart, and I think it's just the beginning.</div><div><br /></div>
