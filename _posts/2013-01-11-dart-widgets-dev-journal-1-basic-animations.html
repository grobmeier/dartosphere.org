---
title: 'Dart Widgets Dev Journal 1 - Basic Animations'
layout: post
tags:
    - dartlang
    - Programming
category: kevinwork
published: '2013-01-11T09:50:00-08:00'

---

<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://kevmoo.github.com/widget.dart/" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-GziCm1MUz28/UPBNIGEa1KI/AAAAAAAAIFs/L2IPI__Zka4/s1600/Screen+Shot+2013-01-11+at+12.00.54+PM.png" /></a></div><blockquote class="tr_bq"><a href="http://en.wiktionary.org/wiki/TLDR">tl;dr</a>: Implementing features similar to <a href="http://twitter.github.com/bootstrap/">Bootstrap</a> is hard without basic animation support in Dart. Basic animation support is not as easy as you'd think. <a href="https://github.com/kevmoo/widget.dart">I've made a stab</a>. <a href="http://kevmoo.github.com/widget.dart/">Check out the demo</a>.</blockquote>I've started a new Dart project - <a href="https://github.com/kevmoo/widget.dart/">Dart Widgets</a>. The inspiration is <a href="http://twitter.github.com/bootstrap/">Bootstrap</a>, but with a focus on features that map cleanly to <a href="https://dvcs.w3.org/hg/webcomponents/raw-file/tip/explainer/index.html">Web Components</a>.<br /><br />While digging into Bootstrap, I realized that there was a heavy dependency on <a href="http://jquery.com/">jQuery</a>--specifically the <a href="http://api.jquery.com/category/effects/basics/">show/hide/toggle</a> functionality. This is critical for expanders, menus, modals, pretty much everything.<br /><h2>Show, hide, toggle</h2>It turns out implementing show/hide/toggle is not as easy as one might guess.<br /><br />One could naively toggle <code>display: none;</code> in an element's style attribute and call it a day, but a lot of edge cases would be missed.<br /><br />Throw in the ability to optionally animate the show/hide behavior and things get a lot more complicated.<br /><br />A short list of the cases to ponder:<br /><br /><ul><li>Element with a non-standard display value. (e.g. a div inherited a display of inline-block)</li><li>Element with a local display of none&nbsp;</li><li>Element inherited a display of none</li><li>Show is called while an element is hiding and vice versa</li><li>Toggle is called 10 times before the first animation finishes</li><li>Show is called on an element with effect A while effect B is hiding it.</li></ul>Huge props to the jQuery and jQuery-ui folks for tackling this problem. Their code served a great starting spot. I feel bad that they had to implement this logic in Javascript.<br /><h2>Test</h2>I can't tell you how valuable test-driven development was in getting this project off the ground. It would have been next to impossible to ensure all of the edge cases were handled cleanly.<br /><br />I need to write another post about how my approach to testing in Dart has evolved. Let's just say I didn't code up 939 tests by hand.<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://github.com/kevmoo/widget.dart/" imageanchor="1"><img border="0" height="476" src="http://3.bp.blogspot.com/--JP3TGuagMk/UPBOirhAPII/AAAAAAAAIF8/QiFrC-ZMmtY/s640/Screen+Shot+2013-01-11+at+12.28.41+PM.png" width="640" /></a></div>After a lot of head scratching, I think I ended up with pretty clean, extensible model.<br /><br />As proof, I offer the <a href="https://github.com/kevmoo/widget.dart/blob/b1cec11ff67cafe94a7c954f7e759b1211b1576f/lib/src/effects/css3_transition_effects.dart#L52">code</a> for doing a open/close door effect:<br /><br /><pre><b>class</b> DoorEffect <b>extends</b> Css3TransitionEffect {<br />  DoorEffect() : <b>super</b>(<br />    '-webkit-transform',<br />    'perspective(1000px) rotateY(90deg)',<br />    'perspective(1000px) rotateY(0deg)',<br />    {'-webkit-transform-origin': '0% 50%'}<br />  );<br />}</pre><br />There are still a few things I'd like to get working--<a href="https://github.com/kevmoo/widget.dart/issues/8">get tests working in Firefox</a>, <a href="https://github.com/kevmoo/widget.dart/issues/7">find a way to handle browser prefixes cleanly</a>--but generally I'm happy with progress.<br /><br />Check out the <a href="http://kevmoo.github.com/widget.dart/">demo</a>.<br /><br />Check out the <a href="https://github.com/kevmoo/widget.dart/">code</a>.<br /><br />Let me know what you think.
