---
title: 'Create unified interfaces across dart:io and dart:html'
layout: post
tags:
    - dart
    - dartlang
category: seth-ladds-blog
published: '2013-06-12T15:16:00-07:00'

---

Dart runs on the client, thanks to dart:html, and on the command line, thanks to dart:io. However, like oil and water, those two libraries just don't mix. Your web apps can't use dart:io, and your server apps can't use dart:html. Normally, this isn't a problem, because the two different targets are oh so very different. However, some concepts are common, such as Web sockets or HTTP requests. Wouldn't it be nice to have a unified interface to Web sockets that works with either dart:io or dart:html? I'll spare you the suspense: Yes!<div><br /></div><div>This post shows you one strategy to design a high-level interface for functionality that exists in both dart:io and dart:html. While the Dart team has the concept of configurability on their radar, not much concrete action has happened. In the meantime, try this strategy and you too can experiment with unifying interfaces and APIs. Code reuse FTW!</div><div><br /></div><div>(This post was inspired by Mark Bennett's <a href="https://plus.google.com/104431949275766772757/posts/2zqWy1RcKi6">original question</a> who is trying to build a more unified Web Socket interface.)</div><div><br /></div><div><span style="font-size: large;">Step 1: Create a library and an interface</span></div><div><br /></div><div>Design the interface that unifies something from dart:html and dart:io.</div><div><br /></div><div><pre style="border: 0px; padding: 0px;"><div class="line" id="LC1" style="border: 0px; margin: 0px; padding: 0px 0px 0px 10px;"><br /><span style="color: #333333; font-family: Consolas, Liberation Mono, Courier, monospace;"><span style="font-size: 12px; line-height: 18px;"><b>library shared;<br /><br />abstract class BaseFoo {<br />  common();<br />}</b></span></span></div><br /></pre></div><div><br /></div><div><span style="font-size: large;">Step 2: Implement the interface for dart:html</span></div><div><br /></div><div>In another library, implement the interface with dart:html:</div><div><br /></div><div><pre style="border: 0px; padding: 0px;"><div class="line" id="LC1" style="border: 0px; margin: 0px; padding: 0px 0px 0px 10px;"><br /><span style="color: #333333; font-family: Consolas, Liberation Mono, Courier, monospace;"><span style="font-size: 12px; line-height: 18px;"><b>library html_thing;<br /><br />import 'dart:html';<br />import 'shared_interface.dart';<br /><br />class Foo extends BaseFoo {<br />  common() {<br />    print('from html');<br />  }<br />}</b></span></span></div><br /></pre></div><div><br /></div><div><span style="font-size: large;">Step 3: Implement the interface for dart:io</span></div><div><br /></div><div>In another library, implement the interface with dart:io.</div><div><br /></div><div><pre style="border: 0px; padding: 0px;"><div class="line" id="LC1" style="border: 0px; margin: 0px; padding: 0px 0px 0px 10px;"><br /><span style="color: #333333; font-family: Consolas, Liberation Mono, Courier, monospace;"><span style="font-size: 12px; line-height: 18px;"><b>library io_thing;<br /><br />import 'dart:io';<br />import 'shared_interface.dart';<br /><br />class Foo extends BaseFoo {<br />  common() {<br />    print('from io');<br />  }<br />}</b></span></span></div><br /></pre></div><div><br /></div><div><span style="font-size: large;">Step 4: Package it up</span></div><div><br /></div><div>All of the previous code can go into the same pub package.</div><div><br /></div><div><span style="font-size: large;">Pick a library to use</span></div><div><br /></div><div>The consumer of your pub package must decide which library to import. For example, a dart:io app might look like this:</div><div><br /></div><div><pre style="border: 0px; padding: 0px;"><div class="line" id="LC1" style="border: 0px; margin: 0px; padding: 0px 0px 0px 10px;"><br /><span style="color: #333333; font-family: Consolas, Liberation Mono, Courier, monospace;"><span style="font-size: 12px; line-height: 18px;"><b>import 'dart:io';<br /><br />import 'package:sharedinterfacetest/io_version.dart';<br /><br />main() {<br />  var foo = new Foo();<br />  foo.common();<br />}</b></span></span></div><br /></pre></div><div><br /></div><div>Hope that helps! All the <a href="https://github.com/sethladd/dart-shared-interface-example">code for this example</a> is found at Github.</div><img src="http://feeds.feedburner.com/~r/SethLaddsBlog/~4/qeeH6ri5tdg" height="1" width="1"/>
