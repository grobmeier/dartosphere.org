---
title: 'Excited to see dart2js minified output getting smaller (real world numbers below)'
layout: post
tags:
    - dartlang
category: kevinwork
published: '2012-11-16T06:58:00-08:00'

---

<div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.dartlang.org/" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://gravatar.com/avatar/a6dba8dde1d2e987545720e40b4a529c?s=200" /></a></div><br /><br />I noticed <a href="http://code.google.com/p/dart/source/detail?r=15005">r15005</a> turns on more renaming in dart2js with --minify so I thought I'd see the impact on <a href="http://dart-lang.github.com/pop-pop-win/">Pop, Pop, Win!</a><br /><br />The last time I did a build and deploy of PPW was on r14873.<br /><br />Here are the sizes of game.dart.js<br /><br /><table><tbody><tr><td>dart2js</td><td>617,201 bytes</td></tr><tr><td>closure compiler</td><td>621.07KB</td></tr><tr><td>gzip (via http)</td><td>107.7KB</td></tr></tbody></table><br />Notes:<br /><ul><li>dart2js is running with the --minify flag</li><li>I'm using the <a href="http://code.google.com/p/closure-compiler/">closure-compiler</a> with default settings. Build from 17 Sept, 2012</li><li>Notice how the output is bigger from closure? This is because output is optimized for gzip. Not intuitive, until you see the network panel in Chrome Dev Tools.</li><li>gzip is the size Chrome sees over the wire. Most servers gzip payloads. It's critical to pay attention to this number and not just the size on disk.</li></ul><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-8-5r9ATUd6o/UKZT8R0UpzI/AAAAAAAAIBE/_5gpcnBdJ9w/s1600/Screen+Shot+2012-11-16+at+8.56.51+AM.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="46" src="http://1.bp.blogspot.com/-8-5r9ATUd6o/UKZT8R0UpzI/AAAAAAAAIBE/_5gpcnBdJ9w/s640/Screen+Shot+2012-11-16+at+8.56.51+AM.jpg" width="640" /></a></div><br />Now with the bleeding edge build r15005<br /><br /><table><tbody><tr><td>dart2js</td><td>451,183 bytes</td><td><b>~33% smaller</b></td></tr><tr><td>closure compiler</td><td>388.71 KB</td><td><b>~37% smaller</b></td></tr><tr><td>gzip (via http)</td><td>90.2KB</td><td><b>~16% smaller</b></td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-nSFvHp0lbYY/UKZUDNN3tYI/AAAAAAAAIBM/l04l1M31IqY/s1600/Screen+Shot+2012-11-16+at+9.47.56+AM.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-nSFvHp0lbYY/UKZUDNN3tYI/AAAAAAAAIBM/l04l1M31IqY/s1600/Screen+Shot+2012-11-16+at+9.47.56+AM.png" /></a></div><br />Notes:<br /><ul><li>The output from dart2js is <b>substantially smaller</b>. This is just the work from the dart2js guys recently. Amazing.</li><li>This time the output from the closure is smaller than the input (~12%). I can only speculate why. Perhaps the new minified output is more optimizable?</li><li>The gain with gzip is not as big (~16%). I'm not surprised by this. PPW is a pretty big game. The json that stores the texture data alone is huge.</li></ul><br />Keep in mind, the Dart source for the game is 1.5 MB as reported by dart2js.<br /><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">info: compiled 1576654 bytes Dart -&gt; 451183 bytes JavaScript in web/game.dart.js</span></blockquote>Is it fair to say we're getting ~94% smaller output? It depends on how valid one considers the the Dart code size reported by dart2js.<br /><br />But I certainly don't feel I need to justify the javascript output size for non-trivial apps anymore.<br /><br />Great work folks!
