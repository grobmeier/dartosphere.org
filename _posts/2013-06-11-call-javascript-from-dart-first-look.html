---
title: 'Call JavaScript from Dart - First Look'
layout: post
tags:
    - dart
    - dartlang
category: seth-ladds-blog
published: '2013-06-11T13:40:00-07:00'

---

You can use <a href="http://www.dartlang.org/">Dart</a> to access existing JavaScript code, thanks to the <a href="http://www.dartlang.org/articles/js-dart-interop/">Dart-JS Interop</a> package. Call JavaScript functions from Dart, send Dart callbacks to JavaScript, and more!<br /><div><br /></div><div><div class="separator" style="clear: both; text-align: center;"><img border="0" height="383" src="http://4.bp.blogspot.com/-nyg0xW8FKp4/UbeJQncDAdI/AAAAAAAAXps/LNa77SHI1kw/s400/4594527045_c38b45d85d.jpg" width="400" /></div><br /><div><br /></div><div>The <a href="http://api.dartlang.org/">Dart core libraries</a> have a lot of functionality provided out of the box (collections, querying the DOM, dates and times, math, and more), so you can get quite far with just the Dart SDK and the many <a href="http://pub.dartlang.org/">pub packages</a>. However, there are plenty of useful JavaScript libraries that can really help enhance Dart web apps. Luckily, Dart can synchronously talk to JavaScript!</div><div><br /></div><div><span style="font-family: inherit; font-size: large;">Step 1: Install the js package</span></div><div><br /></div><div>Add the following to your pubspec.yaml file:</div><div><br /></div><div><span style="font-family: Courier New, Courier, monospace;">dependencies:</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; js: any</span></div><div><br /></div><div><span style="font-size: large;">Step 2: Get a JavaScript library</span></div><div><br /></div><div>Hugs make you feel better, let's use the hugs.js library:</div><div><br /></div><div><div><span style="font-family: Courier New, Courier, monospace;">function Hug(strength) {</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; this.strength = strength;</span></div><div><span style="font-family: Courier New, Courier, monospace;">}</span></div><div><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace;">Hug.prototype.embrace = function(length) {</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; return 'Thanks, that was a good hug for ' + length + ' minutes!';</span></div><div><span style="font-family: Courier New, Courier, monospace;">}</span></div><div><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace;">Hug.prototype.patBack = function(onDone) {</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; onDone('All done.');</span></div><div><span style="font-family: Courier New, Courier, monospace;">}</span></div></div><div><br /></div><div>Be sure to include the JavaScript files in your main HTML file:</div><div><br /></div><div><span style="font-family: Courier New, Courier, monospace;">&lt;script src="hugs.js"&gt;&lt;/script&gt;</span><br /><span style="font-family: Courier New, Courier, monospace;">&lt;script src="packages/browser/dart.js"&gt;&lt;/script&gt;</span><br /><span style="font-family: Courier New, Courier, monospace;">&lt;script src="packages/browser/interop.js"&gt;&lt;/script&gt;</span></div><div><br /></div><div><span style="font-size: large;">Step 3: Write Dart code</span></div><div><br /></div><div><div class="p1"><span style="font-family: Courier New, Courier, monospace;"><span class="s1">import</span><span class="s2"> </span>'dart:html'<span class="s2">;</span></span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;"><span class="s1">import</span><span class="s2"> </span>'package:js/js.dart'<span class="s2"> </span><span class="s1">as</span><span class="s2"> js;</span></span></div><div class="p2"><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;"><span class="s1">void</span> <span class="s3">main</span>() {</span></div><div class="p4"><span style="font-family: Courier New, Courier, monospace;"><span class="s2">&nbsp; </span>// Grab the context from JS land.</span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;">&nbsp; <span class="s1">var</span> context = js.<span class="s4">context</span>;</span></div><div class="p2"><span style="font-family: Courier New, Courier, monospace;">&nbsp;&nbsp;</span></div><div class="p4"><span style="font-family: Courier New, Courier, monospace;"><span class="s2">&nbsp; </span>// Use the [] notation to let --minify work.</span></div><div class="p4"><span style="font-family: Courier New, Courier, monospace;"><span class="s2">&nbsp; </span>// See https://github.com/dart-lang/js-interop/issues/86</span></div><div class="p2"><span style="font-family: Courier New, Courier, monospace;">&nbsp;&nbsp;</span></div><div class="p4"><span style="font-family: Courier New, Courier, monospace;"><span class="s2">&nbsp; </span>// Get a proxy to the JS object.</span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;">&nbsp; <span class="s1">var</span> hug = <span class="s1">new</span> js.Proxy(<span class="s5">context</span>[<span class="s6">'Hug'</span>]);</span></div><div class="p2"><span style="font-family: Courier New, Courier, monospace;">&nbsp;&nbsp;</span></div><div class="p4"><span style="font-family: Courier New, Courier, monospace;"><span class="s2">&nbsp; </span>// Call the embrace method and pass in 10.</span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;">&nbsp; <span class="s1">var</span> result = <span class="s5">hug</span>[<span class="s6">'embrace'</span>](<span class="s7">10</span>);</span></div><div class="p2"><span style="font-family: Courier New, Courier, monospace;">&nbsp;&nbsp;</span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;">&nbsp; query(<span class="s6">'#output'</span>).<span class="s4">text</span> = result;</span></div><div class="p2"><span style="font-family: Courier New, Courier, monospace;">&nbsp;&nbsp;</span></div><div class="p4"><span style="font-family: Courier New, Courier, monospace;"><span class="s2">&nbsp; </span>// Call the patBack method and pass in a callback.</span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;">&nbsp; <span class="s5">hug</span>[<span class="s6">'patBack'</span>](<span class="s1">new</span> js.Callback.once((msg) {</span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; query(<span class="s6">'#output'</span>).appendText(<span class="s6">' This just in: </span>$msg<span class="s6">'</span>);</span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;">&nbsp; }));</span></div><br /><div class="p3"><span style="font-family: Courier New, Courier, monospace;">}</span></div><div class="p3"><br /></div><div class="p3">The hug instance is accessed via a js.Proxy object. You can even pass a Dart function as a callback to a JavaScript function!</div><div class="p3"><br /></div><div class="p3"><span style="font-size: large;">Summary</span></div><div class="p3"><br /></div><div class="p3">Use the Dart-JS interop library to access the billions of existing JavaScript libraries from Dart. Read the <a href="http://draft.blogger.com/"><span id="goog_1062396048"></span>article<span id="goog_1062396049"></span></a> for more details and see examples that use the Twitter API, Google Maps API, and the Google Charts API from Dart. The pub package is <a href="https://github.com/dart-lang/js-interop">open source on Github</a>, and is maintained by Googlers and engineers from the community.</div><br /><br /></div></div>Photo Credit: <a href="http://www.flickr.com/photos/41768119@N04/4594527045/">Gloson</a> <a href="http://creativecommons.org/licenses/by-nc/2.0/">cc</a><img src="http://feeds.feedburner.com/~r/SethLaddsBlog/~4/PcfW_htZibY" height="1" width="1"/>
