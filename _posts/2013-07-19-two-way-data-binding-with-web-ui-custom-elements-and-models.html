---
title: 'Two-way data binding with Web UI custom elements and models'
layout: post
tags:
    - dart
    - dartlang
    - webui
category: seth-ladds-blog
published: '2013-07-19T14:23:00-07:00'

---

<span style="font-size: large;">Preface</span><br /><br />This could very well be my last Web UI post! The <a href="http://news.dartlang.org/2013/07/introducing-polymer-dart.html">Dart team announced they started on polymer.dart</a>, a port of the <a href="http://www.polymer-project.org/">Polymer project</a> to Dart. Polymer.dart is the next evolution of Web UI. Luckily, the concepts are mostly the same and the syntax is mostly the same, because Web UI is also an implementation of the Web Components.<br /><br />So why am I still writing about Web UI? Lots of people have asked about two-way data binding between a component and a model, so I wanted to have a record of this functionality. Also, what's described below isn't too different than how polymer.dart works (and we'll cover it in a future post).<br /><br />I look forward to the glorious new world of coordinated polyfills and new custom elements. Go go polymer.dart and the Polymer project!<br /><br /><span style="font-size: large;">Intro</span><br /><br />The Dart class that backs a custom element can itself also take part in two-way data binding. This post explores how to bind a model object to a web component property. If a model's field changes, the custom element's property changes. If the custom element's property changes, the model's field changes.<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" height="212" src="http://3.bp.blogspot.com/-pQ1Yw5JtBrE/UembRqdbNwI/AAAAAAAAYqI/t6Y36kOfOE0/s640/Web+UI+two-way+data+binding.png" width="640" /></div><br />(Note: the same technique, with different syntax, should work in polymer.dart as well.)<br /><br />The demo app contains:<br /><ul><li>A model for a Switch</li><li>A custom element for a Toggle</li></ul><div><span style="font-size: large;">The goal</span><br /><br />When the switch is flipped, we want to flip the toggle. When the toggle is flipped, we want to flip the switch. Both Switch and Toggle don't know about each other. Let's connect them!</div><div><br /></div><div><span style="font-size: large;">Defining the Switch model</span></div><div><br /></div><div>The Switch class is a standard business model, and it's marked as&nbsp;@observable.</div><div><br /></div><div><pre style="background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> library toggle;  <br />   <br /> import 'package:web_ui/web_ui.dart';  <br />   <br /> <u><b>@observable</b></u>  <br /> class Switch {  <br />  String flipped = 'off';  <br /> }  <br /></code></pre><br /><span style="font-size: large;">Defining the ToggleComponent</span><br /><br /></div><div>The Toggle custom element has two files: the &lt;element&gt; definition and the Dart class.<br /><br />The Dart class for ToggleComponent is also&nbsp;@observable, and has a single field: state.<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> library turn_off;  <br />   <br /> import 'package:web_ui/web_ui.dart';  <br />   <br /> <u><b>@observable</b></u>  <br /> class ToggleComponent extends WebComponent {  <br />  String state = 'On';  <br />    <br />  void toggle() {  <br />   if (state == 'On') {  <br />    state = 'Off';  <br />   } else {  <br />    state = 'On';  <br />   }  <br />  }  <br /> }  <br /></code></pre><br />The custom component renders a button, and displays the state field. The button changes the state field by calling the toggle() method.<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> &lt;!DOCTYPE html&gt;  <br />   <br /> &lt;html&gt;  <br />  &lt;body&gt;  <br />   &lt;element name="toggle" constructor="ToggleComponent" extends="div"&gt;  <br />    &lt;template&gt;  <br />     &lt;button on-click="toggle()"&gt;Toggle&lt;/button&gt;  <br />     &lt;p&gt;Inside the component: The toggle is {{state}}&lt;/p&gt;  <br />    &lt;/template&gt;  <br />    &lt;script type="application/dart" src="toggle_component.dart"&gt;&lt;/script&gt;  <br />   &lt;/element&gt;  <br />  &lt;/body&gt;  <br /> &lt;/html&gt;  <br /></code></pre><br /><span style="font-size: large;">Initializing and controlling the switch</span><br /><br />Inside the main app, create a single Switch instance and two methods that turn the switch on or off.<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> library app;  <br />   <br /> import 'dart:html';  <br /> import 'package:web_ui/web_ui.dart';  <br /> import 'switch.dart';  <br />   <br /> Switch lightSwitch = new Switch();  <br />   <br /> turnSwitchOn() {  <br />  lightSwitch.flipped = 'On';  <br /> }  <br />   <br /> turnSwitchOff() {  <br />  lightSwitch.flipped = 'Off';  <br /> }  <br />   <br /> void main() {  <br /> }  <br /></code></pre><br /><span style="font-size: large;">Connecting the Switch to the Toggle</span><br /><br />Web UI supports two-way binding on custom elements with its <i>bind-foo</i>&nbsp;attribute, where foo is the name of a property on the custom element's backing class.<br /><br />In this example, we bind toggle's state to switch's flipped field. This code comes from <a href="https://github.com/sethladd/dart-web-components-tests/blob/master/web/bind_component_field_to_model_field/app.html">app.html</a>:<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">   <u><b>&lt;div is="toggle" bind-state="lightSwitch.flipped"&gt;&lt;/div&gt;</b></u>  <br />     <br />   &lt;p&gt;The switch is set to {{lightSwitch.flipped}}&lt;/p&gt;  <br />     <br />   &lt;p&gt;  <br />    &lt;button on-click="turnSwitchOn()"&gt;Turn Switch On&lt;/button&gt;  <br />    &lt;button on-click="turnSwitchOff()"&gt;Turn Switch Off&lt;/button&gt;  <br />   &lt;/p&gt;  <br /></code></pre><br /><span style="font-size: large;">Live demo</span><br /><br /><iframe height="200" src="http://sethladd.github.io/dart-web-components-tests/deploy/bind_component_field_to_model_field/out/bind_component_field_to_model_field/app.html" width="680"></iframe></div><br />Press the Toggle button (the custom component) and it runs toggle() which flips the ToggleComponent's internal state field. Because state is bound to lightSwitch.flipped, the switch is also flipped. Pretty cool!<br /><br /><span style="font-size: large;">Summary</span><br /><br />You can bind a component's property to a model's field. This works today with Web UI's <i>bind-foo</i>&nbsp;attribute, and should work with polymer.dart's <i>foo="{{model.field}}"</i>&nbsp;attribute.<br /><br />Meanwhile, Web UI is being phased out in favor of polymer.dart. Both libraries have the same goal: provide excellent implementations of modern and emerging web specifications and to help developers build amazing modular and beautiful web apps!<img src="http://feeds.feedburner.com/~r/SethLaddsBlog/~4/ZE_wvtKuC5w" height="1" width="1"/>
